{% extends "foodcateringtem/frontend.html" %}
{% load static %}

{% block maincontent %}
<!-- Hero Section -->
<section class="h-screen bg-[url('{% static "partyservices.jpg" %}')] bg-cover bg-center flex items-center justify-center">
  <div class="text-center text-white px-6 py-16 bg-black/60 rounded-3xl max-w-4xl">
    <h2 class="text-4xl md:text-5xl font-extrabold mb-6 drop-shadow-lg">Party Pack Menu</h2>
    <p class="text-lg md:text-xl max-w-3xl mx-auto leading-relaxed drop-shadow">
      Explore our specially curated party packs ‚Äî fresh, flavorful, and perfect for your events.
    </p>
    <a href="#menu" 
       class="mt-8 inline-block bg-amber-500 hover:bg-amber-600 text-white font-semibold py-3 px-10 rounded-full shadow-xl transition duration-300 transform hover:scale-105">
      View Menu üçΩÔ∏è
    </a>
  </div>
</section>

<!-- Menu Section -->
<section id="menu" class="py-20 bg-gray-50">
  <div class="max-w-7xl mx-auto px-6 md:px-12 space-y-12">

    <div class="grid grid-cols-1 md:grid-cols-3 gap-10">

      {% for category in categories %}
      <form method="POST" action="{% url 'success' %}">
        {% csrf_token %}

        <div class="menu-card bg-white rounded-3xl shadow-2xl p-6 flex flex-col transition-transform transform hover:scale-105 hover:shadow-2xl">
          
          <!-- Category Header -->
          <div class="flex flex-col items-center mb-4 text-center">
            <h3 class="text-3xl font-bold text-{{ category.color }}">{{ category.name }}</h3>
            <span class="mt-2 font-semibold text-gray-800 text-lg bg-gray-100 px-4 py-1 rounded-full shadow-inner">
              {{ category.price_info }}
            </span>
          </div>

          <!-- Toggle to show dishes -->
          <button type="button" class="toggle-text text-amber-500 font-semibold mb-4 hover:text-amber-600 transition-all duration-300">
            Click to view dishes
          </button>

          <!-- Dishes List -->
          <div class="dishes hidden w-full flex flex-col space-y-3">

            {% for dish in category.dishes.all %}
            <div class="flex flex-col gap-2 p-3 border border-gray-200 rounded-xl bg-gray-50 hover:bg-gray-100 transition duration-300">
              
              <!-- Dish Name and Checkbox if no options -->
              <div class="flex items-center gap-3">
                {% if not dish.options1.all %}
                  <input type="checkbox" name="dishes_{{ category.id }}" value="{{ dish.id }}" class="accent-amber-500 w-4 h-4">
                  <span class="font-semibold text-gray-700 text-lg">{{ dish.name }}</span>
                {% else %}
                  <span class="font-semibold text-gray-700 text-lg">{{ dish.name }}</span>
                {% endif %}
              </div>

              {% if dish.options1.all %}
              <!-- Dish has options: radio buttons -->
              <div class="flex flex-col gap-1 ml-6 mt-2">
                {% for option in dish.options1.all %}
                <label class="flex items-center gap-2 cursor-pointer">
                  <input type="radio" name="dish_{{ dish.id }}" value="{{ option.id }}" class="accent-amber-500 w-4 h-4">
                  <span>{{ option.name }}</span>
                </label>
                {% endfor %}
              </div>
              {% endif %}

            </div>
            {% endfor %}

          </div>

          <!-- Event Date Input under options -->
          <div class="mt-6 p-4 bg-white rounded-2xl border border-gray-200 shadow-inner">
            <label for="event_date_{{ category.id }}" class="block text-lg font-bold text-gray-800 mb-2 text-center">
              Select Your Event Date:
            </label>
            <input type="date" id="event_date_{{ category.id }}" name="event_date"
                   class="w-full p-3 border-2 border-amber-300 rounded-xl text-gray-700 focus:ring-amber-500 focus:border-amber-500 transition duration-200"
                   required>
          </div>

          <!-- Submit button per category -->
          <div class="mt-6 text-center">
    <button 
        type="submit" 
        name="category_id" 
        value="{{ category.id }}"
        {% if not request.user.is_authenticated %} disabled {% endif %}
        class="bg-amber-500 hover:bg-amber-600 text-white font-bold py-3 px-8 rounded-full shadow-xl transition duration-300 transform hover:scale-105
               {% if not request.user.is_authenticated %} opacity-50 cursor-not-allowed hover:scale-100 hover:bg-amber-500 {% endif %}">
        Confirm Selection üç±
    </button>
</div>


        </div>
      </form>
      {% endfor %}

    </div>
  </div>
</section>

<!-- JS: Accordion Toggle -->
<script>
  document.querySelectorAll('.menu-card').forEach(card => {
    const toggleText = card.querySelector('.toggle-text');
    const dishes = card.querySelector('.dishes');

    toggleText.addEventListener('click', () => {
      dishes.classList.toggle('hidden');
      toggleText.textContent = dishes.classList.contains('hidden') ? 'Click to view dishes' : 'Hide dishes';
    });
  });
</script>
{% endblock %}
